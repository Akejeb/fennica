---
title: "Gaudeamus Figures"
author: "Leo Lahti and Mikko Tolonen"
date: "`r Sys.Date()`"
output: markdown_document
---

```{r, echo=FALSE, message=FALSE}
library(dplyr)
dfo <- readRDS("df.Rds")
```

```{r Gaudeamus_Vaasa, echo=FALSE, fig.width=20, fig.height=10}
df <- dfo
df <- df %>% filter(!is.na(publication_year))
tmp1 <- df %>% filter(publication_place == "Vaasa") %>%
     	       group_by(publication_decade, publication_year) %>%
	       tally() %>%
	       arrange(publication_year)

#tmp1$decade <- as.numeric(paste0(substr(tmp1$publication_year,1,3),"0"))
tmp2 <- tmp1 %>% group_by(publication_decade) %>% summarise(m = sum(n)/10)

years <- c(1764,1809,1863,1917)
p <- ggplot(tmp1, aes(x = publication_year, y = n)) +
       geom_point() +
       geom_bar(aes(x = publication_decade + 5, y = m), stat = "identity", fill = "gray", alpha = 0.9, color = "black", data = tmp2) +
       ggtitle("Julkaisutoiminta Vaasassa 1764-1917") +
       ylab("Dokumenttia / vuosi") +
       scale_x_continuous(labels = years, breaks = years) +
       xlab("Julkaisuvuosi") 

print(p)
```


